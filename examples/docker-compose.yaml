version: "3.8"

services:
  gateway:
    image: ghcr.io/apollo/device-gateway:dev
    # If you prefer the local binary, you can use build: ../ with a Dockerfile.
    environment:
      - APOLLO_GATEWAY_TOKEN=devtoken
    ports:
      - "8080:8080"
    command: ["/apollo-deviceprocess-gateway", "--addr=:8080", "--default-heartbeat-seconds=15", "--stale-multiplier=3"]

  agent-tor1-01:
    image: ghcr.io/apollo/device-agent:dev
    environment:
      - APOLLO_DEVICE_NAME=tor1-01
      - APOLLO_GATEWAY_URL=http://gateway:8080
      - APOLLO_DEVICE_TOKEN=devtoken

  agent-tor1-02:
    image: ghcr.io/apollo/device-agent:dev
    environment:
      - APOLLO_DEVICE_NAME=tor1-02
      - APOLLO_GATEWAY_URL=http://gateway:8080
      - APOLLO_DEVICE_TOKEN=devtoken
